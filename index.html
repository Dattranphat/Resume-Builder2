<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced English: Animal Vocabulary & Usage</title>
    <style>
        /* Base Styles - Consider a slightly more professional font if desired */
        body {
            font-family: "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; /* Example: Segoe UI */
            background-color: #e8f0f2; /* Slightly muted background */
            text-align: center;
            padding: 15px;
            color: #263238; /* Dark Blue Grey */
            line-height: 1.6;
        }
        .game-container {
            max-width: 900px; /* Wider for potentially longer text */
            margin: 20px auto;
        }
        h1 {
            color: #004d40; /* Dark Teal */
            margin-top: 0;
            margin-bottom: 30px;
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            font-weight: 600; /* Slightly bolder */
        }

        /* Animal Selection Gallery */
        #animalGallery {
            margin-bottom: 35px;
            padding: 15px;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 51, 77, 0.08);
        }
        .gallery-group-header {
            text-align: left;
            margin: 25px 0 15px 10px;
            font-size: 1.3rem;
            font-weight: 600;
            color: #00695c; /* Medium Teal */
            border-bottom: 2px solid #b2dfdb;
            padding-bottom: 6px;
        }
        .gallery-group-content {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); /* Slightly larger items */
            gap: 20px;
            width: 100%;
            margin-bottom: 25px;
        }
        .animal-selector {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px 8px;
            border: 1px solid #cfd8dc; /* Light border */
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
            position: relative;
            background-color: #fff; /* Ensure bg for shadow */
        }
        .animal-selector:hover:not(.completed) {
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(0, 77, 64, 0.1); /* Teal shadow */
            border-color: #4db6ac;
        }
        .animal-selector .emoji {
            font-size: clamp(2.8rem, 7vw, 3.8rem);
            line-height: 1;
            margin-bottom: 8px;
        }
        .animal-selector .name {
            font-size: 0.85rem;
            font-weight: 500;
            color: #004d40;
        }

        /* Completed State */
        .animal-selector.completed {
            opacity: 0.6;
            filter: grayscale(50%);
            cursor: default;
            background-color: #e0f2f1; /* Very Light Teal */
            box-shadow: none;
            border-color: #cfd8dc;
            pointer-events: none;
        }
        .animal-selector.completed::after {
            content: '‚úì'; /* Unicode check */
            position: absolute;
            top: 6px;
            right: 6px;
            font-size: 1.3rem;
            font-weight: bold;
            color: #00796b; /* Teal check */
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            padding: 0 4px;
            line-height: 1;
        }

        /* Active Game Area */
        #activeGameArea {
            margin-top: 25px;
            padding: 30px; /* More padding */
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 51, 77, 0.1);
            display: none; /* Initially hidden */
            border: 2px solid #004d40;
            text-align: center;
        }
         #activeGameArea.visible { display: block; }
        .animal-image-active {
            font-size: clamp(5rem, 14vw, 7rem);
            margin: 10px 0 15px 0;
            min-height: 80px;
            line-height: 1;
        }
        .word-display-active {
            font-size: clamp(2rem, 5vw, 2.8rem);
            margin: 10px 0 20px 0;
            color: #004d40;
            font-weight: 600;
            min-height: 45px;
            word-wrap: break-word;
        }
         .options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px; /* Slightly more gap */
            margin: 30px auto; /* Centered margin */
            min-height: 120px;
            max-width: 600px; /* Limit width of options */
        }
        .options button {
            background: #00796b; /* Teal buttons */
            color: white;
            border: none;
            border-radius: 8px;
            padding: 16px 20px; /* More padding */
            font-size: 1.05rem; /* Slightly larger font */
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s, opacity 0.3s;
            text-align: left;
            line-height: 1.5; /* Adjust line height */
            font-weight: 400; /* Normal weight for base text */
        }
        .options button strong {
            font-weight: 700; /* Bolder */
            color: #e0f2f1; /* Light teal highlight */
             background-color: rgba(0, 77, 64, 0.2); /* Subtle background for bold */
             padding: 0 3px;
             border-radius: 3px;
        }
        .options button:hover:not(:disabled) { background: #00695c; }
        .options button:active:not(:disabled) { transform: scale(0.99); }
        .options button.correct {
            background: #43a047; /* Slightly darker Green */
            font-weight: 500; /* Medium weight for correct button */
            color: white;
        }
        .options button.correct strong { font-weight: 700; color: #e8f5e9; background-color: rgba(27, 94, 32, 0.3); }
        .options button:disabled { cursor: not-allowed; }
        .options button.faded { opacity: 0.65; background-color: #78909c; } /* Blue Grey faded */

        .feedback { font-size: 1.15rem; margin: 20px auto; min-height: 30px; font-weight: 500; transition: color 0.3s; max-width: 600px; line-height: 1.6; }
        .feedback.correct-feedback { color: #2e7d32; } /* Dark Green */
        .feedback.info-feedback { color: #1976d2; } /* Blue */
        .feedback.wrong-feedback { color: #c62828; } /* Dark Red */

        /* Reset Button */
        #resetButtonContainer { margin-top: 40px; }
        #resetButton {
             padding: 12px 30px; font-size: 1.05rem; background-color: #d84315; /* Deep Orange */ color: white; border: none; border-radius: 8px; cursor: pointer; transition: background-color 0.2s; font-weight: 500;
        }
         #resetButton:hover { background-color: #bf360c; }

        /* Responsive */
         @media (max-width: 768px) {
             .gallery-group-content { grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); }
             .gallery-group-header { font-size: 1.2rem; }
             .options button { padding: 14px 18px; font-size: 1rem; }
         }
         @media (max-width: 480px) {
             .gallery-group-content { grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 15px;}
             .gallery-group-header { font-size: 1.1rem; margin-left: 0; }
             .animal-selector .emoji { font-size: 2.8rem; }
             #activeGameArea { padding: 20px 15px; }
             .animal-image-active { font-size: 4.5rem; }
             .word-display-active { font-size: 1.8rem; }
             .options button { padding: 12px 15px; font-size: 0.95rem;}
             .feedback { font-size: 1.05rem;}
         }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>Advanced English: Animal Traits & Usage</h1>

        <div id="animalGallery">
             <!-- Animal groups and selectors will be added here by JS -->
        </div>

        <div id="activeGameArea">
            <div id="animalImageActive" class="animal-image-active"></div>
            <div id="wordDisplayActive" class="word-display-active"></div>
            <div id="feedbackArea" class="feedback">Select the sentence that uses the most precise or idiomatic language for the context.</div>
            <div id="options" class="options"></div>
        </div>

         <div id="resetButtonContainer">
             <button id="resetButton">Reset Progress</button>
         </div>

    </div>

    <script>
        // Wrap in IIFE
        (function() {
            // Advanced Word Data focusing on nuance, collocations, and precise verbs
            const wordData = {
                // --- Group: Swift Movement ---
                "FISH": {
                    emoji: "üê†", groupConcept: "Swift Movement",
                    keyUsageExample: "The small fish <strong>darted</strong> away from the predator.", // Precise verb
                    alternativeExamples: ["The fish moved quickly through the water.", "The fish swam fast to escape.", "The fish proceeded rapidly underwater."]
                },
                "HORSE": {
                    emoji: "üê¥", groupConcept: "Swift Movement",
                    keyUsageExample: "The racehorse <strong>galloped</strong> across the finish line.", // Specific gait
                    alternativeExamples: ["The horse ran at high speed.", "The horse moved quickly on the track.", "The horse sprinted towards the end."]
                },
                "DEER": {
                    emoji: "ü¶å", groupConcept: "Swift Movement",
                    keyUsageExample: "The startled deer <strong>bounded</strong> gracefully into the woods.", // Evokes jumping motion
                    alternativeExamples: ["The deer ran away quickly.", "The deer jumped swiftly over the log.", "The deer moved rapidly into the trees."]
                },
                "RABBIT": {
                    emoji: "üê∞", groupConcept: "Swift Movement",
                    keyUsageExample: "The rabbit <strong>scurried</strong> into its burrow when it sensed danger.", // Quick, short steps
                    alternativeExamples: ["The rabbit hopped away fast.", "The rabbit ran quickly underground.", "The rabbit moved rapidly to safety."]
                },
                 "MOUSE": {
                    emoji: "üê≠", groupConcept: "Swift Movement",
                    keyUsageExample: "The mouse <strong>scampered</strong> across the kitchen floor.", // Similar to scurry, light/quick
                    alternativeExamples: ["The mouse ran quickly over the floor.", "The mouse moved fast along the ground.", "The tiny mouse traversed the area."]
                },
                 "SNAKE": {
                    emoji: "üêç", groupConcept: "Swift Movement", // Can also be stealth
                    keyUsageExample: "The snake <strong>slithered</strong> silently through the tall grass.", // Specific verb for snakes
                    alternativeExamples: ["The snake moved quietly in the grass.", "The snake crawled smoothly along.", "The reptile proceeded without noise."]
                },

                // --- Group: Vocalization ---
                "DOG": {
                    emoji: "üê∂", groupConcept: "Vocalization",
                    keyUsageExample: "The guard dog <strong>barked</strong> fiercely at the intruder.", // Standard verb
                    alternativeExamples: ["The dog made loud noises at the person.", "The dog shouted aggressively.", "The canine vocalized loudly."]
                },
                "CAT": {
                    emoji: "üê±", groupConcept: "Vocalization",
                    keyUsageExample: "The contented cat <strong>purred</strong> loudly while being petted.", // Specific sound
                    alternativeExamples: ["The cat made a soft vibrating noise.", "The happy cat sounded pleased.", "The feline expressed contentment audibly."]
                },
                "LION": {
                    emoji: "ü¶Å", groupConcept: "Vocalization",
                    keyUsageExample: "The lion's mighty <strong>roar</strong> echoed across the savanna.", // Key noun/verb
                    alternativeExamples: ["The lion made a very loud sound.", "The big cat shouted powerfully.", "The predator vocalized with great volume."]
                },
                 "WOLF": {
                    emoji: "üê∫", groupConcept: "Vocalization",
                    keyUsageExample: "The lone wolf <strong>howled</strong> mournfully at the full moon.", // Specific sound
                    alternativeExamples: ["The wolf made a long, sad sound.", "The wild canine cried out to the moon.", "The animal vocalized with a wailing tone."]
                },
                 "OWL": {
                    emoji: "ü¶â", groupConcept: "Vocalization",
                    keyUsageExample: "The owl <strong>hooted</strong> softly from the treetop in the darkness.", // Specific sound
                    alternativeExamples: ["The night bird made its typical sound.", "The owl called out quietly.", "The nocturnal bird vocalized from the tree."]
                },
                "BEE": {
                     emoji: "üêù", groupConcept: "Vocalization", // Or Sound Production
                     keyUsageExample: "The bees <strong>buzzed</strong> actively around the hive.", // Specific sound
                     otherDescriptions: ["The insects made a low humming sound.", "The swarm sounded busy.", "The bees created noise near their home."]
                 },

                // --- Group: Predation & Stealth ---
                "TIGER": {
                    emoji: "üêÖ", groupConcept: "Predation & Stealth",
                    keyUsageExample: "The tiger <strong>prowled</strong> stealthily through the undergrowth, stalking its prey.", // Prowl implies stealthy hunting
                    alternativeExamples: ["The tiger walked quietly looking for food.", "The large cat moved sneakily in the jungle.", "The predator advanced hidden in the foliage."]
                },
                 "FOX": {
                    emoji: "ü¶ä", groupConcept: "Predation & Stealth",
                    keyUsageExample: "The cunning fox <strong>crept</strong> towards the henhouse under the cover of darkness.", // Crept implies stealth
                    alternativeExamples: ["The fox moved quietly near the chickens.", "The sly animal approached silently.", "The predator advanced carefully towards its target."]
                },
                 "SPIDER": {
                    emoji: "üï∑Ô∏è", groupConcept: "Predation & Stealth",
                    keyUsageExample: "The spider patiently waited, perfectly still, to <strong>ambush</strong> unsuspecting insects.", // Ambush implies surprise attack
                    alternativeExamples: ["The spider waited to catch bugs.", "The arachnid stayed hidden to trap prey.", "The creature remained motionless before attacking."]
                 },


                // --- Group: Unique Adaptations ---
                "ELEPHANT": {
                    emoji: "üêò", groupConcept: "Unique Adaptations",
                    keyUsageExample: "The elephant skillfully <strong>manipulated</strong> objects using its prehensile trunk.", // Precise verb for trunk use
                    alternativeExamples: ["The elephant used its long nose to grab things.", "The elephant picked up items with its trunk.", "The large mammal handled objects with its facial appendage."]
                },
                "GIRAFFE": {
                    emoji: "ü¶í", groupConcept: "Unique Adaptations",
                    keyUsageExample: "The giraffe's elongated neck allows it to <strong>browse</strong> on high foliage inaccessible to others.", // Browse = eat leaves/twigs
                    alternativeExamples: ["The giraffe uses its long neck to eat high leaves.", "The tall animal reaches high branches for food.", "The giraffe feeds on vegetation others cannot get."]
                },
                "CAMEL": { // Adding Camel for adaptation
                     emoji: "üê™", groupConcept: "Unique Adaptations",
                     keyUsageExample: "The camel is perfectly <strong>adapted</strong> to survive in arid desert environments.", // Key concept verb
                     alternativeExamples: ["The camel lives well in the dry desert.", "The camel can handle hot, sandy places.", "The animal is suited for water-scarce regions."]
                 },
                 "PENGUIN": {
                    emoji: "üêß", groupConcept: "Unique Adaptations",
                    keyUsageExample: "Penguins possess dense, waterproof feathers providing insulation against the frigid Antarctic waters.", // Focus on feature's function
                    alternativeExamples: ["Penguins have special feathers for the cold.", "The bird's feathers keep it warm in icy water.", "Penguins are protected from the cold by their plumage."]
                 },
                 "TURTLE": {
                    emoji: "üê¢", groupConcept: "Unique Adaptations",
                    keyUsageExample: "The turtle can <strong>retract</strong> its head and limbs into its protective carapace.", // Retract = pull back into
                    alternativeExamples: ["The turtle hides inside its hard shell.", "The reptile pulls its body parts into its shell.", "The turtle goes into its shell for safety."]
                 },

                // --- Group: Social Behavior ---
                 "MONKEY": {
                    emoji: "üêµ", groupConcept: "Social Behavior",
                    keyUsageExample: "Monkeys often engage in social <strong>grooming</strong> to strengthen troop bonds.", // Specific social action
                    alternativeExamples: ["Monkeys clean each other's fur.", "The primates interact by picking through hair.", "Members of the group maintain hygiene together."]
                 },
                  "BEE": { // Also fits here
                      emoji: "üêù", groupConcept: "Social Behavior",
                      keyUsageExample: "Bees exhibit complex social structures, <strong>cooperating</strong> within the hive for survival.", // Cooperating is key
                      alternativeExamples: ["Bees work together in their home.", "The insects live in an organized group.", "The hive functions through collective effort."]
                  },
                  "WOLF": { // Also fits here
                      emoji: "üê∫", groupConcept: "Social Behavior",
                      keyUsageExample: "Wolves hunt <strong>cooperatively</strong> in packs to bring down large prey.", // Cooperative hunting
                      alternativeExamples: ["Wolves hunt together in groups.", "The pack works as a team to get food.", "Group hunting is typical for wolves."]
                  },
                   "DOLPHIN": { // Also fits here
                      emoji: "üê¨", groupConcept: "Social Behavior",
                      keyUsageExample: "Dolphins communicate and socialize within pods using a complex range of clicks and whistles.", // Social communication
                      alternativeExamples: ["Dolphins talk to each other in groups.", "The sea mammals interact within their pods.", "Group communication is important for dolphins."]
                  }
                  // Add more animals and concepts as needed
            };


            // --- DOM Elements ---
            const gallery = document.getElementById('animalGallery');
            const activeGameArea = document.getElementById('activeGameArea');
            const animalImageActive = document.getElementById('animalImageActive');
            const wordDisplayActive = document.getElementById('wordDisplayActive');
            const optionsContainer = document.getElementById('options');
            const feedbackArea = document.getElementById('feedbackArea');
            const resetButton = document.getElementById('resetButton');

            // --- Game State ---
            let currentKeySentence = '';
            let currentWordKey = '';

            // --- Initialization ---
            function initializeGallery() {
                gallery.innerHTML = '';

                const groupedAnimals = {};
                for (const key in wordData) {
                    const animal = wordData[key];
                    const group = animal.groupConcept || "Miscellaneous";
                    if (!groupedAnimals[group]) {
                        groupedAnimals[group] = [];
                    }
                    groupedAnimals[group].push(key);
                }

                // Define a logical order for advanced concepts
                const groupOrder = ["Swift Movement", "Vocalization", "Predation & Stealth", "Unique Adaptations", "Social Behavior", "Miscellaneous"];

                groupOrder.forEach(groupName => {
                    if (!groupedAnimals[groupName]) return;

                    const groupHeader = document.createElement('h2');
                    groupHeader.className = 'gallery-group-header';
                    groupHeader.textContent = groupName.replace(/ & /g, ' / '); // Format header text nicely
                    gallery.appendChild(groupHeader);

                    const groupContent = document.createElement('div');
                    groupContent.className = 'gallery-group-content';
                    gallery.appendChild(groupContent);

                    groupedAnimals[groupName].sort();

                    groupedAnimals[groupName].forEach(key => {
                        const animal = wordData[key];
                        const selectorDiv = document.createElement('div');
                        selectorDiv.className = 'animal-selector';
                        selectorDiv.dataset.animalKey = key;

                        const emojiSpan = document.createElement('span');
                        emojiSpan.className = 'emoji';
                        emojiSpan.textContent = animal.emoji;

                        const nameSpan = document.createElement('span');
                        nameSpan.className = 'name';
                        nameSpan.textContent = key.charAt(0) + key.slice(1).toLowerCase();

                        selectorDiv.appendChild(emojiSpan);
                        selectorDiv.appendChild(nameSpan);

                        selectorDiv.addEventListener('click', handleAnimalSelection);
                        groupContent.appendChild(selectorDiv);
                    });
                });
            }

            // --- Event Handlers ---
            function handleAnimalSelection(event) {
                const clickedSelector = event.currentTarget;
                if (clickedSelector.classList.contains('completed')) return;

                currentWordKey = clickedSelector.dataset.animalKey;
                const data = wordData[currentWordKey];
                if (!data) return;

                clearActiveGameArea();

                animalImageActive.textContent = data.emoji;
                wordDisplayActive.textContent = currentWordKey.charAt(0) + currentWordKey.slice(1).toLowerCase();
                currentKeySentence = data.keyUsageExample; // Correct variable name

                let allOptions = [data.keyUsageExample, ...data.alternativeExamples]; // Use correct property names
                allOptions = shuffleArray(allOptions);
                displayOptions(allOptions);

                // Refined prompt for advanced level
                showFeedback(`For the ${wordDisplayActive.textContent}, choose the sentence demonstrating the most precise or idiomatic usage:`, "info-feedback");
                activeGameArea.classList.add('visible');
                activeGameArea.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }

            function handleReset() {
                clearActiveGameArea();
                activeGameArea.classList.remove('visible');
                gallery.querySelectorAll('.animal-selector.completed').forEach(selector => {
                    selector.classList.remove('completed');
                    selector.style.pointerEvents = 'auto';
                });
                gallery.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            // --- Core Logic Functions ---
            function displayOptions(options) {
                optionsContainer.innerHTML = "";
                options.forEach(optionHTML => {
                    const button = document.createElement("button");
                    button.innerHTML = optionHTML;
                    button.onclick = function() {
                        checkAnswer(button.innerHTML, button);
                    };
                    optionsContainer.appendChild(button);
                });
            }

            function checkAnswer(selectedSentenceHTML, clickedButton) {
                optionsContainer.querySelectorAll("button").forEach(btn => {
                    btn.disabled = true;
                });

                let bestAnswerButton = null;
                optionsContainer.querySelectorAll("button").forEach(btn => {
                    if (btn.innerHTML === currentKeySentence) {
                        bestAnswerButton = btn;
                    }
                });

                if (bestAnswerButton) {
                    bestAnswerButton.classList.add("correct");
                    bestAnswerButton.style.border = "3px solid #388e3c";
                }

                const galleryItem = gallery.querySelector(`.animal-selector[data-animal-key="${currentWordKey}"]`);
                if (galleryItem) {
                    galleryItem.classList.add('completed');
                    galleryItem.style.pointerEvents = 'none';
                }

                // Provide more explanatory feedback for advanced learners
                if (clickedButton === bestAnswerButton) {
                    // Extract the key term for explanation (remove strong tags for feedback)
                    const keyTerm = bestAnswerButton.querySelector('strong') ? bestAnswerButton.querySelector('strong').textContent : '[key term]';
                    showFeedback(`Correct! "${keyTerm}" is precise and idiomatic here. Well done! Select another animal.`, "correct-feedback");
                } else {
                     // Explain why the chosen one is less ideal compared to the best one
                     const bestTerm = bestAnswerButton.querySelector('strong') ? bestAnswerButton.querySelector('strong').textContent : '[best term]';
                     showFeedback(`While factually plausible, that phrasing isn't as precise or common as the highlighted option using "${bestTerm}". Select another animal.`, "info-feedback");
                    clickedButton.classList.remove('correct');
                    clickedButton.classList.add('faded');
                }

                optionsContainer.querySelectorAll("button").forEach(btn => {
                    if (btn !== bestAnswerButton && btn !== clickedButton) {
                        btn.classList.add('faded');
                        btn.classList.remove('correct');
                    }
                });
            }

            // --- Helper Functions ---
            function showFeedback(message, className) {
                feedbackArea.innerHTML = message; // Use innerHTML if feedback might contain formatting
                feedbackArea.className = `feedback ${className}`;
            }

            function clearOptions() {
                optionsContainer.innerHTML = "";
            }

            function clearActiveGameArea() {
                animalImageActive.textContent = '';
                wordDisplayActive.textContent = '';
                clearOptions();
                feedbackArea.innerHTML = ''; // Use innerHTML
                feedbackArea.className = 'feedback';
                 optionsContainer.querySelectorAll("button").forEach(btn => {
                    btn.disabled = false;
                    btn.classList.remove('correct', 'faded');
                    btn.style.border = 'none';
                    btn.style.opacity = '1';
                 });
            }


            function shuffleArray(array) {
                let currentIndex = array.length, randomIndex;
                while (currentIndex !== 0) {
                    randomIndex = Math.floor(Math.random() * currentIndex);
                    currentIndex--;
                    [array[currentIndex], array[randomIndex]] = [
                        array[randomIndex], array[currentIndex]];
                }
                return array;
            }

            // --- Start ---
            function runGame() {
                initializeGallery();
                resetButton.addEventListener('click', handleReset);
                 // Set initial feedback
                 showFeedback("Select an animal from the gallery to test your vocabulary and usage knowledge.", "info-feedback");
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', runGame);
            } else {
                runGame();
            }

        })(); // End IIFE
    </script>

</body>
</html>
